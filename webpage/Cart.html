
<!DOCTYPE html>
<html>
<head>
<!--bootstrap-->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<!--css-->
<link href="css/page.css" rel="stylesheet">
<style type="text/css">
/*#DIV1{
    width:200px;　
    line-height:50px;　
    padding:20px;
    border:2px blue solid;
    margin-right:10px;　

}*/
body {
	background-color: powderblue;
}


div.underborder{
   
  position: relative;
  top: 100px;
  width: 1000px;
  height: 1100px;
  border-style: solid;
  border-width: 10px 4px 4px 4px;
  border-color: rgb(231, 142, 24);
  background-color:#06821f;
}

div.cart-title{/*上片的bar*/
  position: relative;
  top: 0px;
  background-color:darkgoldenrod;
  border:1px solid #000;
  border-bottom-left-radius:30px;
  border-bottom-right-radius: 30px;
  width: 900px;
  height: 50px; 
}
Class.mybutto {   /*total*/
    
	box-shadow: 3px 4px 0px 0px #899599;
	background:linear-gradient(to bottom, #ededed 5%, #bab1ba 100%);
	background-color:#ededed;
	border-radius:15px;
	border:1px solid #d6bcd6;
	display:inline-block;
	cursor:pointer;
	color:#3a8a9e;
	font-family:Arial;
	font-size:17px;
	padding:7px 25px;
	text-decoration:none;
	text-shadow:0px 1px 0px #e1e2ed;
    width:30px;
    height:20px;
}
class.myButton:hover {
	background:linear-gradient(to bottom, #bab1ba 5%, #ededed 100%);
	background-color:#bab1ba;
}
class.myButton:active {
	position:relative;
	top:1px;
}
#div1{/*商品價個數量*/
    float:left;
     margin-top: 5px;
    margin-bottom: 5px;
    margin-right: 60px;
    margin-left: 80px;
    color:aliceblue;
    font-size:30px
}
#tobuyup{
        
        width:1000px;
        height:80px;
        background-color:rgb(152, 128, 66);
        border-style :dotted;
        border-color: #b8571e;
}
#tobuy{
        margin-bottom: 0px;
        width:1000px;
        height:120px;
        background-color:darkgoldenrod;
        border-style : solid;
        border-color: #b8571e;
    }
#div2{/*for showing product*/
    position: relative;
    top: 20px;
    background-color:blanchedalmond;
    border:3px solid #000;
    width:850px;
    height:80px;
    padding-left: 70px;
    margin-left:40px;
    margin-top:20px;
    font-size:30px;
    font-weight:bold;
    /*float:left;*/
}
#div3{
        background-color: rgb(87, 93, 111);
        font-weight:bold;
        font-size:35px;
        color:rgb(6, 9, 17);
        margin-left:60px;
        margin-right:10px;
        width:140px;
        height:70px;
        /*width:20px;
        height:20px;*/
        border-radius: 5px;
        border-width: 4px 4px 4px 4px;
        border-color:rgb(98, 52, 52);
        align-items: center;
        align-content: center;
    float:left;
    word-break: break-all;
}

</style>
    

<script type="text/javascript">
    window.onload=ShowCart;
    
    function ShowCart(){

        var newProduct='';
        var request=new XMLHttpRequest;
        /*request.open("get","https://cors-anywhere.herokuapp.com/https://ntou-sell.herokuapp.com/backend/cart/geps?uid=1");*/
        request.open("get","/backend/cart/geps");
        request.onreadystatechange = function() { 
        if (request.readyState === 4 && request.status === 200) {
        var type = request.getResponseHeader("Content-Type");
        if (type.match(/^text/)){ // Make sure response is text
		var datastr = JSON.parse(request.responseText);
		var len  = datastr.length;
        
		var str= "";
		for (var i = 0; i < len; i++) {
           
			var content = 
                '<div id="div2">'+
                '<div style= "float:left">'+
                ' <button type="button" id="'+datastr[i].Pdid+'" style="width:40px;height:30px;font-size:10px;background-color:#3949AB;margin-right:10px;border-radius: 5px;" onclick="dele(this.id);">'+"刪除"+'</button>'+
                '<input type="checkbox" style="width:30px;height:30px;" id="box1" name="test" value="56">'+
                '</div>'+
                
                '<div id="div3">'+datastr[i].PdName+
                '</div>'+
                '<div id="div3">'+datastr[i].Price+
                '</div>'+
                '<div id="div3">'+datastr[i].Amount+
                '</div>'+
                
                '</div>';
           
            //偵錯用  console.log(content);
			newProduct=newProduct+content;
			str+=content;
		};
		
      }
    }
    
      
    document.getElementById("NP").innerHTML=newProduct;
  };
request.send(null);

}
    function dele(id){
        
        var request3 = new XMLHttpRequest;    
        str=""; 
        temp="/backend/cart/remo?pdid="+id;
                            
        request3.open("get",temp);
        request3.onreadystatechange = function() { 
        if (request2.readyState === 4 && request2.status === 200) {
                var type = request2.getResponseHeader("Content-Type");
                    if (type.match(/^text/)){ // Make sure response is text   
                                    }
                                }
                            }
                            request3.send(null);
                            window.location.href="Cart.html";

    }
    function switchMenu( theMainMenu, theSubMenu, theEvent ){
        var SubMenu = document.getElementById( theSubMenu );
        if( SubMenu.style.display == 'none' ){ // 顯示子選單
            SubMenu.style.minWidth = theMainMenu.clientWidth; // 讓子選單的最小寬度與主選單相同 (僅為了美觀)
            SubMenu.style.display = 'inline';
            hideMenu(); // 隱藏子選單
            VisibleMenu = theSubMenu;
        }
        else{ // 隱藏子選單
            if( theEvent != 'MouseOver' || VisibleMenu != theSubMenu ){
                SubMenu.style.display = 'none';
                VisibleMenu = '';
            }
        }
    }

// 隱藏子選單
    function hideMenu(){
        if( VisibleMenu != '' ){
            document.getElementById( VisibleMenu ).style.display = 'none';
        }
        VisibleMenu = '';
    }
    function getData(){
            return 1
    }
    function myFunction() {
      document.getElementById("demo").innerHTML = "Paragraph changed.";
    }
    function addall(){
        return ff
    }
    function temp() {
        var x= document.getElementsByID("temp1");
      document.getElementById("d44d").innerHTML= x;
    }
    function addall(){
            
            var prods=document.getElementsByName("test");
            for (var i=0;i<prods.length;i++){
                if(prods[i].type == "checkbox"){
                prods[i].checked = true;
            
                }
            }
        }
    
    function goToBuy(){
        
        
        
        var msg= "/backend/cart/geps";
        
        var msgsend = "/backend/order/add?";
        var request=new XMLHttpRequest;
        //var request2 = new XMLHttpRequest;
        var datastr = "";
        var st = [];
        request.open("get","/backend/cart/geps"); //前面網址解決CORS
        request.onreadystatechange = function() {
            if (request.readyState === 4 && request.status === 200) { 
                var type = request.getResponseHeader("Content-Type");
                if (type.match(/^text/)){ 
                    datastr = JSON.parse(request.responseText);
                    var prods=document.getElementsByName("test");
                    var str = "";            
                    for (var i = 0; i < prods.length; i++) {
                        if(prods[i].type == "checkbox"&&prods[i].checked == true){   
                            //加入訂單
                            var request2 = new XMLHttpRequest;     
                            str=str+datastr[i].Pdid;
                            var temp="";
                            temp="pdid="+str;
                            str=datastr[i].Amount;
                            temp=temp+("&amount="+str);
                            temp=msgsend+temp;
                            
                            request2.open("get",temp);
                            request2.onreadystatechange = function() { 
                                if (request2.readyState === 4 && request2.status === 200) {
                                    var type = request2.getResponseHeader("Content-Type");
                                    if (type.match(/^text/)){ // Make sure response is text
		                                
                                    }
                                }
                            }
                            request2.send(null);
                            //刪除購物車
                            var request3 = new XMLHttpRequest;    
                            str=""; 
                            
                            temp="/backend/cart/remo?pdid="+datastr[i].Pdid;
                            
                            request3.open("get",temp);
                            request3.onreadystatechange = function() { 
                                if (request2.readyState === 4 && request2.status === 200) {
                                    var type = request2.getResponseHeader("Content-Type");
                                    if (type.match(/^text/)){ // Make sure response is text
		                                
                                    }
                                }
                            }
                            request3.send(null);
                            window.location.href="Cart.html";

                            
                        }
                    }
                }
            }                  
        } 
        alert("已加入訂單");
        request.send(null);

    }
    function totalmoney() {
       
       var newProduct='';
       var request=new XMLHttpRequest;
       /*request.open("get","https://cors-anywhere.herokuapp.com/https://ntou-sell.herokuapp.com/backend/cart/geps?uid=1");*/
       request.open("get","/backend/cart/geps");
       request.onreadystatechange = function() { 
       if (request.readyState === 4 && request.status === 200) {
       var type = request.getResponseHeader("Content-Type");
       if (type.match(/^text/)){ // Make sure response is text
       var datastr = JSON.parse(request.responseText);
       var len  = datastr.length;
       var content="";
       var str= "";
       var mon= Number(0);
       var prods=document.getElementsByName("test");
       for (var i = 0; i < len; i++) {
           if(prods[i].type == "checkbox"&&prods[i].checked ==true){
                   str=datastr[i].Price;
                   var a = Number(str);
                   mon = a+mon;
                   if(i!=0){content = '<div style="float:left;margin-left:10px;font-size:20px;">'+','+datastr[i].PdName+'</div>';}
                    else {content = '<div style="float:left;margin-left:8px;font-size:20px;">'+datastr[i].PdName+'</div>';}
                   newProduct=newProduct+content;
           }
           
       };
       
     }
   }
   
   document.getElementById("SHOWTOT").innerHTML=newProduct;
   document.getElementById("money").innerHTML=mon;
 };
request.send(null);
   }
    function total() {//目前所選
       
        var newProduct='';
        var request=new XMLHttpRequest;
        /*request.open("get","https://cors-anywhere.herokuapp.com/https://ntou-sell.herokuapp.com/backend/cart/geps?uid=1");*/
        request.open("get","/backend/cart/geps");
        request.onreadystatechange = function() { 
        if (request.readyState === 4 && request.status === 200) {
        var type = request.getResponseHeader("Content-Type");
        if (type.match(/^text/)){ // Make sure response is text
		var datastr = JSON.parse(request.responseText);
		var len  = datastr.length;
        
        var str= "";
        var prods=document.getElementsByName("test");
		for (var i = 0; i < len; i++) {
            if(prods[i].type == "checkbox"&& prods[i].checked == true){
                   
                    if(i!=0){var content = '<div style="float:left;margin-left:10px;font-size:20px;">'+','+datastr[i].PdName+'</div>';}
                    else {var content = '<div style="float:left;margin-left:8px;font-size:20px;">'+datastr[i].PdName+'</div>';}
            }
			
           
            //偵錯用  console.log(content);
			
		};
		
      }
    }
    
      
    document.getElementById("SHOWTOT").innerHTML=newProduct;
  };
request.send(null);
    }
</script>
<link href="https://fonts.googleapis.com/css?family=Poppins:100,200,300,400,500,600,700,800,900&display=swap" rel="stylesheet">
<link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-sixteen.css">
    <link rel="stylesheet" href="assets/css/owl.css">

</head>

<body style="margin:0px; padding:0px; background:#fff url(img/bg2.webp) center center fixed no-repeat;background-size:cover; display:block;">

    <header class="">
		<nav class="navbar navbar-expand-lg">
			<div class="container">
			  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false
			  " aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			  </button>
				
			  <a class="navbar-brand" href="MainPage.html"><h2>海大購物 <em>Shop</em></h2></a>
			  
			  <div class="collapse navbar-collapse" id="navbarResponsive">
				<ul class="navbar-nav ml-auto">
				  <li class="nav-item">
					<a class="nav-link" href="MainPage.html">Home
					  <span class="sr-only">(current)</span>
					</a>
				  </li> 
				  <li class="nav-item active">
					<a class="nav-link" href="Cart.html">Cart</a>
				  </li>
				  <li class="nav-item">
					<a class="nav-link" href="Order.html">Order</a>
				  </li>
				  
				  <li class="nav-item">
					<a class="nav-link" href="History.html">History
					 
					</a>
				  </li> 
				  <li class="nav-item">
					<a class="nav-link" href="Sell.html">Sell</a>
                  </li>
                  <li class="nav-item">
					<a class="nav-link"  onclick="logout()">Logout</a>
				  </li>
				</ul>
			  </div>
			</div>
		  </nav>
		</header>
<div id="Div1" align=center>

<!--<p id="demo">A Paragraph.</p>
<p id="d44d">fff</p>
    <button type="button" onclick="temp()">Click Me!</button>
    <button type="button" onclick="myFunction()">Try it</button>
<button type="button" onclick="document.write(5 + 6)">Try it</button>
<script>
var c = document.getElementById("myCanvas");
var ctx = c.getContext("2d");
ctx.fillStyle = "#FF0000";
ctx.fillRect(300, 50, 600, 300);
</script>
<script type="text/javascript">
  function myFun(){
   myTxt = document.myForm.myText;
   alert("你輸入的值："+myTxt.value);
  }
 </script>
 
 <form name="myForm">
  <input type="text" name="myText" value="">
  <input type="button" value="請點擊" onClick="myFun()">
 </form>-->
<div class="underborder">
 <div class="cart-title">
     
     <div id="div1">
         
            <!--<input type="checkbox" name="subscribe" value="1"style="width:20px;height:20px;font-size:20px;color:black;" > -->
         <button type="button" style="background-color:#95852f;width:60px;height:40px;font-weight:bold;border-radius: 5px;" onclick="addall()"><font size="3px">全選</button>
     </div>

     <div id="div1">產品</div>
     <div id="div1">單價</div>
     <div id="div1">數量</div>
     
 </div>
    
   <table height="10"></table>
  <div align="center">
  <table id=NP width="1000" height="800">
	  <h2 style="font-size:40px;font-weight:bold;">商品內容</h2>
      
	  <tr><td>
	  </td></tr>
      
  </table> 

  </div>
<div id="tobuyup">
   
    <div style="float:left">
    <h2 style="float:none;margin-left:0px;">目前所選:</h2>
    </div>
    <div style="float:left">
    <h3 id="SHOWTOT" style="float:none;margin-left:0px;margin-top:15px;font-size: 30px;height:10px;">無</h3>
    </div>   
</div>
<div id="tobuy">
    
    
    <div style="float:left">
    <h2 style="float:none;margin-left:0px;">Total:</h2>
    </div>
    <div style="float:left">
        <h3 id="money" style="float:none;margin-left:0px;margin-top:25px"><font size = "10px">無</font></h3>
    </div>
   

    
    <button type="button" onclick="totalmoney()" style="margin-top:50px;width:110px;height:40px;background-color:gray;"><font size="5">總金額</button>
    
    
     <button type="button" onclick="goToBuy()" style="margin-top:50px;width:80px;height:40px;background-color: gray;"><font size="5">結帳</button>
           <!-- <input class="checkout" type="button">-->    
    
    
</div>

</div>
</div> 

 <!-- Bootstrap core JavaScript -->
 <script src="vendor/jquery/jquery.min.js"></script>
 <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>


 <!-- Additional Scripts -->
 <script src="assets/js/custom.js"></script>
 <script src="assets/js/owl.js"></script>
 <script src="assets/js/slick.js"></script>
 <script src="assets/js/isotope.js"></script>
 <script src="assets/js/accordions.js"></script>


 <script language = "text/Javascript"> 
   cleared[0] = cleared[1] = cleared[2] = 0; //set a cleared flag for each field
   function clearField(t){                   //declaring the array outside of the
   if(! cleared[t.id]){                      // function makes it static and global
       cleared[t.id] = 1;  // you could use true and false, but that's more typing
       t.value='';         // with more chance of typos
       t.style.color='#fff';
       }
   }
 </script>
</body>
</html> 

